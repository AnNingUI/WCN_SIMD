# WCN_SIMD API Coverage Report

## 统一API覆盖情况

本文档说明哪些统一API (`wcn_simd_*`) 在各个平台上可用。

### 图例
- ✅ 硬件原生支持
- 🔄 软件模拟实现
- ❌ 不支持/未实现
- ⚠️ 部分支持

---

## 基础操作 (100% 跨平台)

### Load/Store
| API | x86 SSE2+ | ARM NEON | LoongArch | RISC-V | PowerPC | MIPS | WASM |
|-----|-----------|----------|-----------|--------|---------|------|------|
| `wcn_simd_load_i128` | ✅ | ✅ | ✅ | ✅ | ✅ | ✅ | ✅ |
| `wcn_simd_store_i128` | ✅ | ✅ | ✅ | ✅ | ✅ | ✅ | ✅ |
| `wcn_simd_load_f32` | ✅ | ✅ | ✅ | ✅ | ✅ | ✅ | ✅ |
| `wcn_simd_load_f64` | ✅ | ✅ | ✅ | ✅ | ✅ | ✅ | ✅ |

### 初始化
| API | x86 SSE2+ | ARM NEON | LoongArch | RISC-V | PowerPC | MIPS | WASM |
|-----|-----------|----------|-----------|--------|---------|------|------|
| `wcn_simd_set1_i8/16/32/64` | ✅ | ✅ | ✅ | ✅ | ✅ | ✅ | ✅ |
| `wcn_simd_setzero_*` | ✅ | ✅ | ✅ | ✅ | ✅ | ✅ | ✅ |

### 基础算术
| API | x86 SSE2+ | ARM NEON | LoongArch | RISC-V | PowerPC | MIPS | WASM |
|-----|-----------|----------|-----------|--------|---------|------|------|
| `wcn_simd_add_i8/16/32/64` | ✅ | ✅ | ✅ | ✅ | ✅ | ✅ | ✅ |
| `wcn_simd_sub_i8/16/32/64` | ✅ | ✅ | ✅ | ✅ | ✅ | ✅ | ✅ |
| `wcn_simd_mul_f32/f64` | ✅ | ✅ | ✅ | ✅ | ✅ | ✅ | ✅ |
| `wcn_simd_div_f32/f64` | ✅ | ✅ | ✅ | ✅ | ✅ | ✅ | ✅ |

### 饱和算术
| API | x86 SSE2+ | ARM NEON | LoongArch | RISC-V | PowerPC | MIPS | WASM |
|-----|-----------|----------|-----------|--------|---------|------|------|
| `wcn_simd_adds_i8/i16` | ✅ | ✅ | ✅ | ✅ | ✅ | ✅ | ✅ |
| `wcn_simd_subs_i8/i16` | ✅ | ✅ | ✅ | ✅ | ✅ | ✅ | ✅ |

### 比较操作
| API | x86 SSE2+ | ARM NEON | LoongArch | RISC-V | PowerPC | MIPS | WASM |
|-----|-----------|----------|-----------|--------|---------|------|------|
| `wcn_simd_cmpeq_i8/16/32` | ✅ | ✅ | ✅ | ✅ | ✅ | ✅ | ✅ |
| `wcn_simd_cmpgt_i8/16/32` | ✅ | ✅ | ✅ | ✅ | ✅ | ✅ | ✅ |
| `wcn_simd_cmpeq_f32/f64` | ✅ | ✅ | ✅ | ✅ | ✅ | ✅ | ✅ |

---

## 扩展操作 (部分平台支持)

### 64位整数比较
| API | x86 SSE2+ | ARM NEON | LoongArch | RISC-V | PowerPC | MIPS | WASM |
|-----|-----------|----------|-----------|--------|---------|------|------|
| `wcn_simd_cmpeq_i64` | ✅ SSE4.1+ | ✅ | ✅ | ✅ | 🔄 | ✅ | ✅ |
| `wcn_simd_cmpgt_i64` | ✅ SSE4.2+ | ✅ | ✅ | ✅ | 🔄 | ✅ | ❌ |

**说明**: SSE2需要软件模拟，SSE4.1+有硬件指令

### 无符号Min/Max
| API | x86 SSE2+ | ARM NEON | LoongArch | RISC-V | PowerPC | MIPS | WASM |
|-----|-----------|----------|-----------|--------|---------|------|------|
| `wcn_simd_min_u8/max_u8` | ✅ SSE2 | ✅ | ✅ | ✅ | ✅ | ✅ | ✅ |
| `wcn_simd_min_u16/max_u16` | ✅ SSE4.1+ | ✅ | ✅ | ✅ | 🔄 | ✅ | ✅ |
| `wcn_simd_min_u32/max_u32` | ✅ SSE4.1+ | ✅ | ✅ | ✅ | 🔄 | ✅ | ✅ |

### 水平操作
| API | x86 SSE2+ | ARM NEON | LoongArch | RISC-V | PowerPC | MIPS | WASM |
|-----|-----------|----------|-----------|--------|---------|------|------|
| `wcn_simd_hadd_f32/f64` | ✅ SSE3 | 🔄 | 🔄 | 🔄 | 🔄 | 🔄 | 🔄 |
| `wcn_simd_hadd_i16/i32` | ✅ SSSE3 | 🔄 | ✅ | 🔄 | 🔄 | 🔄 | ❌ |

**说明**: 大多数平台需要软件模拟（多条指令组合）

### 点积
| API | x86 SSE2+ | ARM NEON | LoongArch | RISC-V | PowerPC | MIPS | WASM |
|-----|-----------|----------|-----------|--------|---------|------|------|
| `wcn_simd_dp_f32` | ✅ SSE4.1 | 🔄 | 🔄 | 🔄 | 🔄 | 🔄 | 🔄 |

### 类型转换
| API | x86 SSE2+ | ARM NEON | LoongArch | RISC-V | PowerPC | MIPS | WASM |
|-----|-----------|----------|-----------|--------|---------|------|------|
| `wcn_simd_cvt_i32_f32` | ✅ | ✅ | ✅ | ✅ | ✅ | ✅ | ✅ |
| `wcn_simd_cvt_f32_i32` | ✅ | ✅ | ✅ | ✅ | ✅ | ✅ | ✅ |
| `wcn_simd_cvt_f32_f64` | ✅ | ✅ | ✅ | ✅ | ✅ | ✅ | 🔄 |

### 舍入操作
| API | x86 SSE2+ | ARM NEON | LoongArch | RISC-V | PowerPC | MIPS | WASM |
|-----|-----------|----------|-----------|--------|---------|------|------|
| `wcn_simd_floor_f32` | ✅ SSE4.1 / 🔄 SSE2 | ✅ | ✅ | ✅ | ✅ | ✅ | ✅ |
| `wcn_simd_ceil_f32` | ✅ SSE4.1 / 🔄 SSE2 | ✅ | ✅ | ✅ | ✅ | ✅ | ✅ |
| `wcn_simd_round_f32` | ✅ SSE4.1 / 🔄 SSE2 | ✅ | ✅ | ✅ | ✅ | ✅ | ✅ |

---

## 高级操作 (特定平台)

### Gather/Scatter
| API | x86 SSE2+ | ARM NEON | LoongArch | RISC-V | PowerPC | MIPS | WASM |
|-----|-----------|----------|-----------|--------|---------|------|------|
| `wcn_simd_gather_*` | ✅ AVX2+ | ❌ | ❌ | ✅ | ❌ | ❌ | ❌ |
| `wcn_simd_scatter_*` | ✅ AVX-512+ | ❌ | ❌ | ✅ | ❌ | ❌ | ❌ |

**说明**: 主要是AVX2/AVX-512和RISC-V RVV特性

### 字符串处理
| API | x86 SSE2+ | ARM NEON | LoongArch | RISC-V | PowerPC | MIPS | WASM |
|-----|-----------|----------|-----------|--------|---------|------|------|
| `wcn_simd_cmpestri/cmpistr` | ✅ SSE4.2 | ❌ | ❌ | ❌ | ❌ | ❌ | ❌ |
| `wcn_simd_crc32_*` | ✅ SSE4.2 | ✅ ARMv8 | ❌ | ❌ | ❌ | ❌ | ❌ |

**说明**: 高度平台特定

### 复数运算
| API | x86 SSE2+ | ARM NEON | LoongArch | RISC-V | PowerPC | MIPS | WASM |
|-----|-----------|----------|-----------|--------|---------|------|------|
| `wcn_simd_complex_mul_*` | 🔄 | 🔄 | ✅ SVE2 | 🔄 | 🔄 | 🔄 | 🔄 |

**说明**: ARM SVE2有原生支持，其他平台需多条指令组合

---

## 建议使用策略

### ✅ 推荐在生产环境使用 (100%跨平台)
- 所有基础算术、逻辑、比较操作
- 基础load/store
- 基础类型转换 (i32↔f32)

### ⚠️ 谨慎使用 (需要运行时检测或软件回退)
- 64位整数比较 (SSE2回退性能较差)
- 无符号16/32位min/max (SSE2需回退)
- 水平操作 (多数平台需模拟)
- 舍入操作 (SSE2有软件实现)

### ❌ 避免跨平台代码使用 (特定平台特性)
- Gather/Scatter (仅AVX2+/RISC-V)
- 字符串处理 (仅SSE4.2/部分ARM)
- 原生复数运算 (仅SVE2)

---

## 性能建议

1. **优先使用100%跨平台的基础API** - 性能稳定，移植性好
2. **对扩展API使用运行时检测** - 通过`wcn_simd_get_features()`检查可用性
3. **为关键路径提供多个代码路径** - 硬件加速 + 软件回退
4. **避免在性能关键代码中使用软件模拟的高级功能**

## 实现状态总结

| 类别 | 完全跨平台 | 部分跨平台 | 特定平台 |
|------|------------|------------|----------|
| 基础操作 | 66个API | - | - |
| 扩展操作 | - | 20个API | - |
| 高级操作 | - | - | 15个API |
| **总计** | **66 (65%)** | **20 (20%)** | **15 (15%)** |

当前统一API设计覆盖了最常用的**65%核心操作**,这些操作在所有平台都有良好支持。
